async function buscar() {
    const status = document.getElementById("status");
    const result = document.getElementById("result");
    status.innerHTML = "üîç Buscando en Gmail...";
    
    try {
      const res = await fetch("/api/emails", { cache: "no-store" });
      const data = await res.json();

      if (!data.emails || data.emails.length === 0) {
        status.innerHTML = "‚è≥ Gmail dice que no hay correos nuevos.";
        return;
      }

      // FILTRO FLEXIBLE (Si dice Netflix en cualquier lado, se muestra)
      const filtered = data.emails.filter(e => {
        const fullText = (e.subject + e.html + (e.from || "")).toLowerCase();
        return fullText.includes("netflix");
      });

      if (filtered.length === 0) {
        status.innerHTML = "‚è≥ No se hallaron correos de Netflix en los √∫ltimos recibidos.";
        return;
      }

      result.innerHTML = "";
      filtered.forEach(e => {
        const card = document.createElement("div");
        card.className = "email-card";
        card.innerHTML = `
          <div class="email-header">
            <h3>${e.subject}</h3>
            <p>${e.date || ''}</p>
          </div>
          <div class="email-body">${e.html}</div>
        `;
        result.appendChild(card);
      });

      status.innerHTML = "‚úÖ ¬°Correo encontrado!";
      document.getElementById("sound").play().catch(()=>{});

    } catch (error) {
      status.innerHTML = "‚ùå Error: El servidor no responde.";
    }
  }
